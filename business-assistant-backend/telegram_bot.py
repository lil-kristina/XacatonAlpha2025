import asyncio
from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes
from tokentelegram import token

# –¢–æ–∫–µ–Ω –æ—Ç BotFather
BOT_TOKEN = token

async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
    welcome_text = """
ü§ñ –ü—Ä–∏–≤–µ—Ç! –Ø –ë–∏–∑–Ω–µ—Å-–ü–æ–º–æ—â–Ω–∏–∫!

–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å:
‚Ä¢ –ù–∞–ª–æ–≥–∞–º–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏
‚Ä¢ –î–æ–≥–æ–≤–æ—Ä–∞–º–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏  
‚Ä¢ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–º –∏ –ø—Ä–æ–¥–∞–∂–∞–º–∏
‚Ä¢ –†–∞—Å—á–µ—Ç–∞–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

–ü—Ä–æ—Å—Ç–æ –∑–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å!
    """
    await update.message.reply_text(welcome_text)

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
    help_text = """
üí° –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:
‚Ä¢ "–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–∞—Ü–µ–Ω–∫—É?"
‚Ä¢ "–ö–∞–∫–∏–µ –Ω–∞–ª–æ–≥–∏ –¥–ª—è –ò–ü?"
‚Ä¢ "–ö–∞–∫ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä?" 
‚Ä¢ "–°–æ–≤–µ—Ç—ã –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É"

–ó–∞–¥–∞–π—Ç–µ –ª—é–±–æ–π –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å!
    """
    await update.message.reply_text(help_text)

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    user_message = update.message.text.lower()
    
    # –ü—Ä–æ—Å—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API
    answers = {
        "–Ω–∞—Ü–µ–Ω–∫–∞": "–§–æ—Ä–º—É–ª–∞ –Ω–∞—Ü–µ–Ω–∫–∏: (–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å) / –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å √ó 100%. –ü—Ä–∏–º–µ—Ä: –∫—É–ø–∏–ª–∏ –∑–∞ 100 —Ä—É–±, –ø—Ä–æ–¥–∞–ª–∏ –∑–∞ 150 —Ä—É–±. –ù–∞—Ü–µ–Ω–∫–∞ = (150-100)/100 √ó 100% = 50%",
        "–Ω–∞–ª–æ–≥": "–î–ª—è –ò–ü –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∂–∏–º—ã: –£–°–ù 6% (–¥–æ—Ö–æ–¥—ã) –∏–ª–∏ –£–°–ù 15% (–¥–æ—Ö–æ–¥—ã-—Ä–∞—Å—Ö–æ–¥—ã). –¢–∞–∫–∂–µ –µ—Å—Ç—å –ø–∞—Ç–µ–Ω—Ç –∏ –û–°–ù–û.",
        "–¥–æ–≥–æ–≤–æ—Ä": "–î–æ–≥–æ–≤–æ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å: –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω, –ø—Ä–µ–¥–º–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞, —Å—Ä–æ–∫–∏, —Å—Ç–æ–∏–º–æ—Å—Ç—å, –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ —Å—Ç–æ—Ä–æ–Ω, —Ä–µ–∫–≤–∏–∑–∏—Ç—ã.",
        "–º–∞—Ä–∫–µ—Ç–∏–Ω–≥": "–î–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: —Å–æ—Ü—Å–µ—Ç–∏, —Å–∞—Ä–∞—Ñ–∞–Ω–Ω–æ–µ —Ä–∞–¥–∏–æ, –∞–∫—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, SEO-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å–∞–π—Ç–∞.",
        "—Ñ–∏–Ω–∞–Ω—Å": "–í–µ–¥–∏—Ç–µ —É—á–µ—Ç –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤, —Å–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –±—é–¥–∂–µ—Ç, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥."
    }
    
    # –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ—Ç–≤–µ—Ç
    answer = "–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ: –Ω–∞–ª–æ–≥–∏, –¥–æ–≥–æ–≤–æ—Ä—ã, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥, —Ñ–∏–Ω–∞–Ω—Å—ã –∏–ª–∏ —Ä–∞—Å—á–µ—Ç –Ω–∞—Ü–µ–Ω–∫–∏."
    for key in answers:
        if key in user_message:
            answer = answers[key]
            break
    
    await update.message.reply_text(answer)

async def error_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫"""
    print(f"–û—à–∏–±–∫–∞: {context.error}")
    await update.message.reply_text("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ")

def main():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(BOT_TOKEN).build()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(CommandHandler("start", start_command))
    application.add_handler(CommandHandler("help", help_command))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
    application.add_error_handler(error_handler)
    
    print("ü§ñ Telegram –±–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    application.run_polling()

if __name__ == "__main__":
    main()
